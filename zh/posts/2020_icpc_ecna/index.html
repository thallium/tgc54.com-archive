<!doctype html><html lang=zh><head><title>2020 ICPC East Central NA Regional Contest 总结与题解 ::
Thallium54</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="算是有所进步但还是稍有遗憾，差一题就能进division championships.
更新：所有7题队都以wildcard的身份晋级NADC了，而且如果本学校只有wildcard队的话，会被分到最弱的central division，然后我们又莫名其妙的拿了个第6，晋级NAC了:joy:
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://tgc54.com/zh/posts/2020_icpc_ecna/><link rel=stylesheet href=https://tgc54.com/assets/style.css><link rel=stylesheet href=https://tgc54.com/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://tgc54.com/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://tgc54.com/img/favicon.png><link href=https://tgc54.com/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://tgc54.com/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://tgc54.com/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://tgc54.com/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://tgc54.com/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://tgc54.com/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary"><meta name=twitter:title content="2020 ICPC East Central NA Regional Contest 总结与题解"><meta name=twitter:description content="算是有所进步但还是稍有遗憾，差一题就能进division championships.
更新：所有7题队都以wildcard的身份晋级NADC了，而且如果本学校只有wildcard队的话，会被分到最弱的central division，然后我们又莫名其妙的拿了个第6，晋级NAC了:joy:"><meta property="og:title" content="2020 ICPC East Central NA Regional Contest 总结与题解"><meta property="og:description" content="算是有所进步但还是稍有遗憾，差一题就能进division championships.
更新：所有7题队都以wildcard的身份晋级NADC了，而且如果本学校只有wildcard队的话，会被分到最弱的central division，然后我们又莫名其妙的拿了个第6，晋级NAC了:joy:"><meta property="og:type" content="article"><meta property="og:url" content="https://tgc54.com/zh/posts/2020_icpc_ecna/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-03-10T00:00:00+00:00"><meta property="article:modified_time" content="2021-03-10T00:00:00+00:00"><meta property="og:site_name" content="Thallium54"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css integrity=sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js integrity=sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})'></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"></head><body><div class=container><header class=header><span class=header__inner><a href=/zh class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>Thallium54</span></a>
<span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/zh/posts>博文</a></li><li><a href=/zh/categories>分类</a></li><li><a href=/zh/tags>标签</a></li><li><a href=https://wiki.tgc54.com>Wiki</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/zh/posts>博文</a></li><li><a href=/zh/categories>分类</a></li><li><a href=/zh/tags>标签</a></li><li><a href=https://wiki.tgc54.com>Wiki</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-circle-half-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><path d="M12 3v18"/><path d="M12 14l7-7"/><path d="M12 19l8.5-8.5"/><path d="M12 9l4.5-4.5"/></svg></span><span class=lang-toggle><div class="dropdown menu__sub-inner"><div class=link><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-world" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><line x1="3.6" y1="9" x2="20.4" y2="9"/><line x1="3.6" y1="15" x2="20.4" y2="15"/><path d="M11.5 3a17 17 0 000 18"/><path d="M12.5 3a17 17 0 010 18"/></svg></div><ul class=menu__sub-inner-more><li><a href=https://tgc54.com/zh/posts/2020_icpc_ecna/>简体中文</a></li></ul></div></span></span></span></header><div class=content><div class=post><h1 class=post-title>2020 ICPC East Central NA Regional Contest 总结与题解</h1><div class=post-meta><span class=post-date>2021-03-10</span></div><span class=post-tags><a href=https://tgc54.com/zh/tags/contests/>#Contests</a>&nbsp;</span><div class=post-content><p>算是有所进步但还是稍有遗憾，差一题就能进division championships.</p><p>更新：所有7题队都以wildcard的身份晋级NADC了，而且如果本学校只有wildcard队的话，会被分到最弱的central division，然后我们又莫名其妙的拿了个第6，晋级NAC了:joy:</p><h2 id=比赛过程>比赛过程
<a href=#%e6%af%94%e8%b5%9b%e8%bf%87%e7%a8%8b class=h-anchor aria-hidden=true>#</a></h2><p>两个队友一个简称T，一个简称J。</p><p>开场我从前往后读，A比较长就直接跳过了，读了B感觉有点想法但又不是很确定就接着读，C很明显是个找最大环，一开始还觉得比较麻烦，但想想不是环就是链所以直接dfs就行了。同时队友J读到E发现就是个矩阵乘法于是开始写，我又跟榜做了G。之后不久队友J的E也过了。另一个队友T读了H是贪心但不会写，我此时在写B的暴力（但其实稍微想想暴力肯定超时但不知道为啥还是写完了）。B暴力写完才发现会超时，此时H还没做出来，我看了一眼也没想法，就扔给队友J了。然后发现B好像可以dp，然后就一边想一边写，虽然有点恶心但挺直接的，最后一遍过。写B的过程中队友J过了H，算是签完到了。此时才一个半小时，感觉非常好，比去年顺利多了。</p><p>然后我在做K，感觉是dp，有点思路但不会写，队友J在做J，过了样例但是WA，队友T直接开I了（其实是最难的题orz）。于是三个人都卡题了，不知不觉过了一个半小时我终于放弃了，此时J题过了一大堆，于是我就跟队友J换了一下题，由于队友J用的python而我又懒的看所以就准备重写，然后没想到是个超级恶心模拟题，而且写了一堆bug，离结束还有半小时和队友J几乎同时过了J和K。然后仔细一看A发现很简单但输出格式很恶心，最后虽然勉强写完但没时间debug，以7题收场。</p><h2 id=反思>反思
<a href=#%e5%8f%8d%e6%80%9d class=h-anchor aria-hidden=true>#</a></h2><p>卡题太久没有及时放弃，哪怕去读读别的题。题没有都读一遍，队友J其实读了A但感觉很麻烦，但我感觉比J好做多了（可能我J写的太烂了）。L到最后也没人读，其实也不难，就是个二分图匹配的板子 题。所以说也不能一味的跟榜，毕竟每个人的知识点覆盖不一样。但K卡半天没做出来也不应该。</p><h2 id=题解>题解
<a href=#%e9%a2%98%e8%a7%a3 class=h-anchor aria-hidden=true>#</a></h2><h3 id=a>A
<a href=#a class=h-anchor aria-hidden=true>#</a></h3><p>数据很小，找lca直接暴力网上跳也可以。输出格式比较恶心，要多看几遍，注意不要把<code>11th, 12th, 13th</code>输出成 <code>11st, 12nd, 13rd</code>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define all(x) (x).begin(),(x).end()
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define sz(x) int(x.size())
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> ll <span style=color:#f92672>=</span> <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> pii <span style=color:#f92672>=</span> pair<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> rd(T<span style=color:#f92672>&amp;</span>... args) {((cin<span style=color:#f92672>&gt;&gt;</span>args), ...);}
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> wr(T... args) {((cout<span style=color:#f92672>&lt;&lt;</span>args<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; &#34;</span>), ...); cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;\n&#39;</span>;}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    ios<span style=color:#f92672>::</span>sync_with_stdio(false);
</span></span><span style=display:flex><span>    cin.tie(<span style=color:#66d9ef>nullptr</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n, T;
</span></span><span style=display:flex><span>    cin<span style=color:#f92672>&gt;&gt;</span>n<span style=color:#f92672>&gt;&gt;</span>T;
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>vector<span style=color:#f92672>&lt;</span>string<span style=color:#f92672>&gt;&gt;</span> a(n);
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>string<span style=color:#f92672>&gt;</span> name(n);
</span></span><span style=display:flex><span>    unordered_map<span style=color:#f92672>&lt;</span>string, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> id;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span>n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        cin<span style=color:#f92672>&gt;&gt;</span>name[i];
</span></span><span style=display:flex><span>        id.try_emplace(name[i], id.size());
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> x;
</span></span><span style=display:flex><span>        cin<span style=color:#f92672>&gt;&gt;</span>x;
</span></span><span style=display:flex><span>        a[i].resize(x);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> s : a[i]) {
</span></span><span style=display:flex><span>            cin<span style=color:#f92672>&gt;&gt;</span>s;
</span></span><span style=display:flex><span>            id.try_emplace(s, id.size());
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;&gt;</span> g(id.size());
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> ind(id.size());
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span>n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> u<span style=color:#f92672>=</span>id[name[i]];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> s : a[i]) {
</span></span><span style=display:flex><span>            g[u].push_back(id[s]);
</span></span><span style=display:flex><span>            ind[id[s]]<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> pa(id.size());
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> dep(id.size());
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> dfs<span style=color:#f92672>=</span>[<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> dfs, <span style=color:#66d9ef>int</span> u, <span style=color:#66d9ef>int</span> p) <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>        pa[u] <span style=color:#f92672>=</span> p;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span> v : g[u]) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (v <span style=color:#f92672>==</span> p) <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>            dep[v]<span style=color:#f92672>=</span>dep[u]<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            dfs(dfs, v, u);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> lca<span style=color:#f92672>=</span>[<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>int</span> x, <span style=color:#66d9ef>int</span> y) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>while</span> (x<span style=color:#f92672>!=</span>y) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (dep[x]<span style=color:#f92672>&lt;</span>dep[y]) swap(x, y);
</span></span><span style=display:flex><span>            x<span style=color:#f92672>=</span>pa[x];
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> x;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span>id.size(); i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (ind[i]<span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            dfs(dfs, i, i);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> ordinal<span style=color:#f92672>=</span>[](<span style=color:#66d9ef>int</span> x) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>auto</span> s<span style=color:#f92672>=</span>to_string(x);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (x<span style=color:#f92672>&gt;=</span><span style=color:#ae81ff>11</span> <span style=color:#f92672>&amp;&amp;</span> x<span style=color:#f92672>&lt;=</span><span style=color:#ae81ff>13</span>) <span style=color:#66d9ef>return</span> s<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;th&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (x<span style=color:#f92672>%</span><span style=color:#ae81ff>10</span><span style=color:#f92672>==</span><span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>return</span> s<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;st&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (x<span style=color:#f92672>%</span><span style=color:#ae81ff>10</span><span style=color:#f92672>==</span><span style=color:#ae81ff>2</span>) <span style=color:#66d9ef>return</span> s<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;nd&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (x<span style=color:#f92672>%</span><span style=color:#ae81ff>10</span><span style=color:#f92672>==</span><span style=color:#ae81ff>3</span>) <span style=color:#66d9ef>return</span> s<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;rd&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> s<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;th&#34;</span>;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (T<span style=color:#f92672>--</span>) {
</span></span><span style=display:flex><span>        string s, t;
</span></span><span style=display:flex><span>        cin<span style=color:#f92672>&gt;&gt;</span>s<span style=color:#f92672>&gt;&gt;</span>t;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> l<span style=color:#f92672>=</span>lca(id[s], id[t]);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> m<span style=color:#f92672>=</span>dep[id[s]]<span style=color:#f92672>-</span>dep[l];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> n<span style=color:#f92672>=</span>dep[id[t]]<span style=color:#f92672>-</span>dep[l];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> swaped<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (m<span style=color:#f92672>&gt;</span>n) {
</span></span><span style=display:flex><span>            swap(m, n);
</span></span><span style=display:flex><span>            swaped<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            swap(s, t);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (m<span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            swap(s, t);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (n<span style=color:#f92672>==</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>                cout<span style=color:#f92672>&lt;&lt;</span>s<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; is the child of &#34;</span><span style=color:#f92672>&lt;&lt;</span>t<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;\n&#39;</span>;
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                n<span style=color:#f92672>-=</span><span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>                cout<span style=color:#f92672>&lt;&lt;</span>s<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; is the &#34;</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span>n; i<span style=color:#f92672>++</span>) cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;great &#34;</span>;
</span></span><span style=display:flex><span>                cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;grandchild of &#34;</span><span style=color:#f92672>&lt;&lt;</span>t<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;\n&#39;</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (m<span style=color:#f92672>==</span>n <span style=color:#f92672>&amp;&amp;</span> m<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (swaped) swap(s, t);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (n<span style=color:#f92672>==</span><span style=color:#ae81ff>1</span>) cout<span style=color:#f92672>&lt;&lt;</span>s<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; and &#34;</span><span style=color:#f92672>&lt;&lt;</span>t<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; are siblings</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                n<span style=color:#f92672>--</span>;
</span></span><span style=display:flex><span>                cout<span style=color:#f92672>&lt;&lt;</span>s<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; and &#34;</span><span style=color:#f92672>&lt;&lt;</span>t<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; are &#34;</span><span style=color:#f92672>&lt;&lt;</span>ordinal(n)<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; cousins</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (n<span style=color:#f92672>&gt;</span>m <span style=color:#f92672>&amp;&amp;</span> m<span style=color:#f92672>&gt;</span><span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (swaped) swap(s, t);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (n<span style=color:#f92672>-</span>m<span style=color:#f92672>==</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>                cout<span style=color:#f92672>&lt;&lt;</span>s<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; and &#34;</span><span style=color:#f92672>&lt;&lt;</span>t<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; are &#34;</span><span style=color:#f92672>&lt;&lt;</span> ordinal(m<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; cousins, 1 time removed</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span> 
</span></span><span style=display:flex><span>                cout<span style=color:#f92672>&lt;&lt;</span>s<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; and &#34;</span><span style=color:#f92672>&lt;&lt;</span>t<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; are &#34;</span><span style=color:#f92672>&lt;&lt;</span>ordinal(m<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; cousins, &#34;</span><span style=color:#f92672>&lt;&lt;</span>n<span style=color:#f92672>-</span>m<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; times removed</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=b>B
<a href=#b class=h-anchor aria-hidden=true>#</a></h3><p><code>dp[x][y][i][used][d]</code> 代表是否存在以坐标 $(x, y)$ 的字符结尾，覆盖目标字符串的前<code>i</code>个字符，转向<code>used</code>次，结束时的方向是<code>d</code>的走法。注意长度为$i$的字符串最多转$i-1$次，虽然第一个字符是没有方向的，但为了转移方便就变成了所有方向，所以枚举转向次数的话要限制一下，不然会出现长度为2转两次的走法。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define all(x) (x).begin(),(x).end()
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define sz(x) int(x.size())
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> ll <span style=color:#f92672>=</span> <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> pii <span style=color:#f92672>=</span> pair<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> rd(T<span style=color:#f92672>&amp;</span>... args) {((cin<span style=color:#f92672>&gt;&gt;</span>args), ...);}
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> wr(T... args) {((cout<span style=color:#f92672>&lt;&lt;</span>args<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; &#34;</span>), ...); cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;\n&#39;</span>;}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> dp[<span style=color:#ae81ff>10</span>][<span style=color:#ae81ff>10</span>][<span style=color:#ae81ff>105</span>][<span style=color:#ae81ff>105</span>][<span style=color:#ae81ff>8</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    ios<span style=color:#f92672>::</span>sync_with_stdio(false);
</span></span><span style=display:flex><span>    cin.tie(<span style=color:#66d9ef>nullptr</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n, m;
</span></span><span style=display:flex><span>    cin<span style=color:#f92672>&gt;&gt;</span>n<span style=color:#f92672>&gt;&gt;</span>m;
</span></span><span style=display:flex><span>    vector a(n, vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>char</span><span style=color:#f92672>&gt;</span>(m));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span>n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; j<span style=color:#f92672>&lt;</span>m; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            cin<span style=color:#f92672>&gt;&gt;</span>a[i][j];
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> limit;
</span></span><span style=display:flex><span>    string s;
</span></span><span style=display:flex><span>    cin<span style=color:#f92672>&gt;&gt;</span>limit<span style=color:#f92672>&gt;&gt;</span>s;
</span></span><span style=display:flex><span>    limit<span style=color:#f92672>=</span>min(limit, <span style=color:#66d9ef>int</span>(s.size()));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span>pair<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;&gt;</span> dirs{{<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>}, {<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>}, {<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>1</span>}, {<span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>}, {<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>}, {<span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>}, {<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>}, {<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>}};
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span>n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; j<span style=color:#f92672>&lt;</span>m; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (a[i][j]<span style=color:#f92672>==</span>s[<span style=color:#ae81ff>0</span>]) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> d<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; d<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>8</span>; d<span style=color:#f92672>++</span>) 
</span></span><span style=display:flex><span>                    dp[i][j][<span style=color:#ae81ff>0</span>][<span style=color:#ae81ff>0</span>][d]<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>; i<span style=color:#f92672>&lt;</span>s.size(); i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> x<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; x<span style=color:#f92672>&lt;</span>n; x<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> y<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; y<span style=color:#f92672>&lt;</span>m; y<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (a[x][y]<span style=color:#f92672>!=</span>s[i]) <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> used<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; used<span style=color:#f92672>&lt;=</span>min(limit, i<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>); used<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> d<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; d<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>8</span>; d<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> pd<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; pd<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>8</span>; pd<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>auto</span> [dx, dy]<span style=color:#f92672>=</span>dirs[d];
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>unsigned</span> nx<span style=color:#f92672>=</span>x<span style=color:#f92672>+</span>dx, ny<span style=color:#f92672>=</span>y<span style=color:#f92672>+</span>dy;
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>int</span> pused<span style=color:#f92672>=</span>used<span style=color:#f92672>-</span>(d<span style=color:#f92672>!=</span>pd);
</span></span><span style=display:flex><span>                            <span style=color:#75715e>// if (i==1) pused=0;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                            <span style=color:#66d9ef>if</span> (nx<span style=color:#f92672>&lt;</span>n <span style=color:#f92672>&amp;&amp;</span> ny<span style=color:#f92672>&lt;</span>m <span style=color:#f92672>&amp;&amp;</span> pused<span style=color:#f92672>&gt;=</span><span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> dp[nx][ny][i<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][pused][pd]) {
</span></span><span style=display:flex><span>                                dp[x][y][i][used][d]<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>                            }
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span>n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; j<span style=color:#f92672>&lt;</span>m; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> d<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; d<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>8</span>; d<span style=color:#f92672>++</span>)
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (dp[i][j][s.size()<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][limit][d]) 
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span> cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;Yes&#34;</span>, <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;No&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=c>C
<a href=#c class=h-anchor aria-hidden=true>#</a></h3><p>由于每个物品最多只有一个人要，所以每个点的出度最多为1，所以每个连通分量要么是环要么是链。直接dfs即可。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define all(x) (x).begin(),(x).end()
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define sz(x) int(x.size())
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> ll <span style=color:#f92672>=</span> <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> pii <span style=color:#f92672>=</span> pair<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> rd(T<span style=color:#f92672>&amp;</span>... args) {((cin<span style=color:#f92672>&gt;&gt;</span>args), ...);}
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> wr(T... args) {((cout<span style=color:#f92672>&lt;&lt;</span>args<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; &#34;</span>), ...); cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;\n&#39;</span>;}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    ios<span style=color:#f92672>::</span>sync_with_stdio(false);
</span></span><span style=display:flex><span>    cin.tie(<span style=color:#66d9ef>nullptr</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n;
</span></span><span style=display:flex><span>    cin<span style=color:#f92672>&gt;&gt;</span>n;
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;&gt;</span> g(n);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>node</span> {
</span></span><span style=display:flex><span>        string name, has, wants;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>node<span style=color:#f92672>&gt;</span> a(n);
</span></span><span style=display:flex><span>    unordered_map<span style=color:#f92672>&lt;</span>string, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> names, toys;
</span></span><span style=display:flex><span>    unordered_map<span style=color:#f92672>&lt;</span>string, string<span style=color:#f92672>&gt;</span> wanted_by;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> [name, has, wants] <span style=color:#f92672>:</span> a) {
</span></span><span style=display:flex><span>        cin<span style=color:#f92672>&gt;&gt;</span>name<span style=color:#f92672>&gt;&gt;</span>has<span style=color:#f92672>&gt;&gt;</span>wants;
</span></span><span style=display:flex><span>        names.try_emplace(name, names.size());
</span></span><span style=display:flex><span>        toys.try_emplace(has, toys.size());
</span></span><span style=display:flex><span>        toys.try_emplace(wants, toys.size());
</span></span><span style=display:flex><span>        wanted_by[wants]<span style=color:#f92672>=</span>name;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span>n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (wanted_by.count(a[i].has))
</span></span><span style=display:flex><span>            g[i].push_back(names[wanted_by[a[i].has]]);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> vis(n);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> ans<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> dfs<span style=color:#f92672>=</span>[<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> dfs, <span style=color:#66d9ef>int</span> u, <span style=color:#66d9ef>int</span> dep) <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>void</span>{
</span></span><span style=display:flex><span>        vis[u]<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span> v : g[u]) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (vis[v]<span style=color:#f92672>==</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>                ans<span style=color:#f92672>=</span>max(ans, dep<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                dfs(dfs, v, dep<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        vis[u]<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span>n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>vis[i]) {
</span></span><span style=display:flex><span>            dfs(dfs, i, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (ans) cout<span style=color:#f92672>&lt;&lt;</span>ans;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;No trades possible&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=d>D
<a href=#d class=h-anchor aria-hidden=true>#</a></h3><p>还没来得及补</p><h3 id=e>E
<a href=#e class=h-anchor aria-hidden=true>#</a></h3><p>非常简单的矩阵乘法，队友写的，没要代码。。。</p><h3 id=f>F
<a href=#f class=h-anchor aria-hidden=true>#</a></h3><p>矩阵求逆，模运算下的高斯消元。队友赛后补的</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;string&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define ll long long
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define all(x) (x).begin(),(x).end()
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define sz(x) int(x.size())
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define rep(i, a, b) for(int i = a; i &lt; (b); ++i)
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define FOR(i,n) for(int (i)=0;(i)&lt;(n);++(i))
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define PRE(i,m,n,in) for(int (i)=(m);(i)&lt;(n);i+=in)
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define RPRE(i,m,n,in) for(int (i)=(m);(i)&gt;=(n);i-=in)
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define srt(v) sort(v.begin(),v.end())
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define printv(a) printa(a,0,a.size())
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define debug(x) cout&lt;&lt;#x&#34; = &#34;&lt;&lt;(x)&lt;&lt;endl
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define printa(a,L,R) for(int i=L;i&lt;R;i++) cout&lt;&lt;a[i]&lt;&lt;(i==R-1?&#34;\n&#34;:&#34; &#34;)
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define printv(a) printa(a,0,a.size())
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define print2d(a,r,c) for(int i=0;i&lt;r;i++) for(int j=0;j&lt;c;j++) cout&lt;&lt;a[i][j]&lt;&lt;(j==c-1?&#34;\n&#34;:&#34; &#34;)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>typedef</span> vector<span style=color:#f92672>&lt;</span>string<span style=color:#f92672>&gt;</span>VS;
</span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> pair<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>,<span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>pii;
</span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> pair<span style=color:#f92672>&lt;</span>ll,ll<span style=color:#f92672>&gt;</span>pll;
</span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> vector<span style=color:#f92672>&lt;</span>ll<span style=color:#f92672>&gt;</span>VL;
</span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>VI;
</span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> vector<span style=color:#f92672>&lt;</span>VI<span style=color:#f92672>&gt;</span>VVI;
</span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> vector<span style=color:#f92672>&lt;</span>VL<span style=color:#f92672>&gt;</span>VVL;
</span></span><span style=display:flex><span><span style=color:#66d9ef>typedef</span> vector<span style=color:#f92672>&lt;</span>pii<span style=color:#f92672>&gt;</span>VII;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> MOD <span style=color:#f92672>=</span> <span style=color:#ae81ff>37</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> INF <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>; 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>gauss</span> (vector <span style=color:#f92672>&lt;</span> vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>&gt;</span> <span style=color:#f92672>&amp;</span>a, vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>&amp;</span> ans, <span style=color:#66d9ef>const</span> vector<span style=color:#f92672>&lt;</span>ll<span style=color:#f92672>&gt;&amp;</span>inv) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> n <span style=color:#f92672>=</span> (<span style=color:#66d9ef>int</span>) a.size(); <span style=color:#66d9ef>int</span> m <span style=color:#f92672>=</span> (<span style=color:#66d9ef>int</span>) a[<span style=color:#ae81ff>0</span>].size() <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>  vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> where (m, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> col<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>, row<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; col<span style=color:#f92672>&lt;</span>m <span style=color:#f92672>&amp;&amp;</span> row<span style=color:#f92672>&lt;</span>n; <span style=color:#f92672>++</span>col) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> sel <span style=color:#f92672>=</span> row;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span>row; i<span style=color:#f92672>&lt;</span>n; <span style=color:#f92672>++</span>i)
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> ( a[i][col] <span style=color:#f92672>&gt;</span> a[sel][col]) sel <span style=color:#f92672>=</span> i;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (a[sel][col] <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span>col; i<span style=color:#f92672>&lt;=</span>m; <span style=color:#f92672>++</span>i)
</span></span><span style=display:flex><span>      swap (a[sel][i], a[row][i]);
</span></span><span style=display:flex><span>    where[col] <span style=color:#f92672>=</span> row;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span>n; <span style=color:#f92672>++</span>i) 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (i <span style=color:#f92672>!=</span> row) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> c <span style=color:#f92672>=</span> (a[i][col] <span style=color:#f92672>*</span> inv[a[row][col]]) <span style=color:#f92672>%</span> MOD;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j<span style=color:#f92672>=</span>col; j<span style=color:#f92672>&lt;=</span>m; <span style=color:#f92672>++</span>j)
</span></span><span style=display:flex><span>          a[i][j] <span style=color:#f92672>=</span> (a[i][j] <span style=color:#f92672>-</span> (a[row][j]<span style=color:#f92672>*</span>c <span style=color:#f92672>%</span> MOD) <span style=color:#f92672>+</span> MOD) <span style=color:#f92672>%</span> MOD;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    <span style=color:#f92672>++</span>row;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  ans.assign (m, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span>m; <span style=color:#f92672>++</span>i)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (where[i] <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>      ans[i] <span style=color:#f92672>=</span> (a[where[i]][m] <span style=color:#f92672>*</span> inv[a[where[i]][i]]) <span style=color:#f92672>%</span> MOD;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span>n; <span style=color:#f92672>++</span>i) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> sum <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; j<span style=color:#f92672>&lt;</span>m; <span style=color:#f92672>++</span>j)
</span></span><span style=display:flex><span>      sum <span style=color:#f92672>=</span> (MOD <span style=color:#f92672>+</span> sum <span style=color:#f92672>+</span> (ans[j] <span style=color:#f92672>*</span> a[i][j]) <span style=color:#f92672>%</span> MOD) <span style=color:#f92672>%</span> MOD;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (abs (sum <span style=color:#f92672>-</span> a[i][m]) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span>m; <span style=color:#f92672>++</span>i)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (where[i] <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) <span style=color:#66d9ef>return</span> INF;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>  ios_base<span style=color:#f92672>::</span>sync_with_stdio(false);
</span></span><span style=display:flex><span>  cin.tie(NULL);
</span></span><span style=display:flex><span>  string ns; getline(cin, ns); <span style=color:#66d9ef>int</span> n <span style=color:#f92672>=</span> stoi(ns);
</span></span><span style=display:flex><span>  string s1; getline(cin, s1); 
</span></span><span style=display:flex><span>  string s2; getline(cin, s2);
</span></span><span style=display:flex><span>  vector<span style=color:#f92672>&lt;</span>ll<span style=color:#f92672>&gt;</span> inv(MOD);
</span></span><span style=display:flex><span>  inv[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>; i <span style=color:#f92672>&lt;</span> MOD; <span style=color:#f92672>++</span>i) inv[i] <span style=color:#f92672>=</span> MOD <span style=color:#f92672>-</span> (MOD<span style=color:#f92672>/</span>i) <span style=color:#f92672>*</span> inv[MOD <span style=color:#f92672>%</span> i] <span style=color:#f92672>%</span> MOD;
</span></span><span style=display:flex><span>  vector<span style=color:#f92672>&lt;</span> vector <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>&gt;</span> v1( n , vector <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> ()); 
</span></span><span style=display:flex><span>  vector<span style=color:#f92672>&lt;</span> vector <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>&gt;</span> v2( n , vector <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> ()); 
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> s1.size(); i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> num;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(s1[i] <span style=color:#f92672>&gt;=</span> <span style=color:#e6db74>&#39;A&#39;</span> <span style=color:#f92672>&amp;&amp;</span> s1[i] <span style=color:#f92672>&lt;=</span> <span style=color:#e6db74>&#39;Z&#39;</span>) {
</span></span><span style=display:flex><span>      num <span style=color:#f92672>=</span> <span style=color:#66d9ef>int</span>(s1[i]) <span style=color:#f92672>-</span> <span style=color:#ae81ff>65</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(s1[i] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39; &#39;</span>) num <span style=color:#f92672>=</span> <span style=color:#ae81ff>36</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> num <span style=color:#f92672>=</span> (s1[i] <span style=color:#f92672>-</span> <span style=color:#e6db74>&#39;0&#39;</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>26</span>;
</span></span><span style=display:flex><span>    v1[i <span style=color:#f92672>%</span> n].push_back(num);
</span></span><span style=display:flex><span>  }  
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> s2.size(); i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> num;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(s2[i] <span style=color:#f92672>&gt;=</span> <span style=color:#e6db74>&#39;A&#39;</span> <span style=color:#f92672>&amp;&amp;</span> s2[i] <span style=color:#f92672>&lt;=</span> <span style=color:#e6db74>&#39;Z&#39;</span>) {
</span></span><span style=display:flex><span>      num <span style=color:#f92672>=</span> <span style=color:#66d9ef>int</span>(s2[i]) <span style=color:#f92672>-</span> <span style=color:#ae81ff>65</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(s2[i] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39; &#39;</span>) num <span style=color:#f92672>=</span> <span style=color:#ae81ff>36</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> num <span style=color:#f92672>=</span> (s2[i] <span style=color:#f92672>-</span> <span style=color:#e6db74>&#39;0&#39;</span>) <span style=color:#f92672>+</span> <span style=color:#ae81ff>26</span>;
</span></span><span style=display:flex><span>    v2[i <span style=color:#f92672>%</span> n].push_back(num);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> consistent <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> many <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>int</span> no <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  vector <span style=color:#f92672>&lt;</span>vector <span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>&gt;</span> sol;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;&gt;</span>a(v1[<span style=color:#ae81ff>0</span>].size(), vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>(n <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>b(n);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> v1[<span style=color:#ae81ff>0</span>].size(); j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> k <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; k <span style=color:#f92672>&lt;</span> n; k<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        a[j][k] <span style=color:#f92672>=</span> v1[k][j];
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      a[j][n] <span style=color:#f92672>=</span> v2[i][j]; 
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>ans;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> num <span style=color:#f92672>=</span> gauss(a, ans, inv);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(num <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) no<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(num <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>      consistent<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>      sol.push_back(ans);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> many<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(consistent <span style=color:#f92672>==</span> n) print2d(sol, n, n);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(no <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>1</span>)cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;No solution&#34;</span> <span style=color:#f92672>&lt;&lt;</span> endl;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(many <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>1</span>) cout <span style=color:#f92672>&lt;&lt;</span> <span style=color:#e6db74>&#34;Too many solutions&#34;</span> <span style=color:#f92672>&lt;&lt;</span> endl;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=g>G
<a href=#g class=h-anchor aria-hidden=true>#</a></h3><p>直接模拟即可</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define all(x) (x).begin(),(x).end()
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define sz(x) int(x.size())
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> ll <span style=color:#f92672>=</span> <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> pii <span style=color:#f92672>=</span> pair<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> rd(T<span style=color:#f92672>&amp;</span>... args) {((cin<span style=color:#f92672>&gt;&gt;</span>args), ...);}
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> wr(T... args) {((cout<span style=color:#f92672>&lt;&lt;</span>args<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; &#34;</span>), ...); cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;\n&#39;</span>;}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    ios<span style=color:#f92672>::</span>sync_with_stdio(false);
</span></span><span style=display:flex><span>    cin.tie(<span style=color:#66d9ef>nullptr</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n, m;
</span></span><span style=display:flex><span>    cin<span style=color:#f92672>&gt;&gt;</span>n<span style=color:#f92672>&gt;&gt;</span>m;
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> a(n), rank(n);
</span></span><span style=display:flex><span>    iota(all(a), <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    iota(all(rank), <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (m<span style=color:#f92672>--</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>char</span> c;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> u, v;
</span></span><span style=display:flex><span>        cin<span style=color:#f92672>&gt;&gt;</span>c<span style=color:#f92672>&gt;&gt;</span>u<span style=color:#f92672>&gt;&gt;</span>c<span style=color:#f92672>&gt;&gt;</span>v;
</span></span><span style=display:flex><span>        u<span style=color:#f92672>--</span>, v<span style=color:#f92672>--</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (rank[u]<span style=color:#f92672>&gt;</span>rank[v]) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span>rank[v]; i<span style=color:#f92672>&lt;</span>rank[u]; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                a[i]<span style=color:#f92672>=</span>a[i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>                rank[a[i]]<span style=color:#f92672>=</span>i;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            a[rank[u]<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>]<span style=color:#f92672>=</span>v;
</span></span><span style=display:flex><span>            rank[v]<span style=color:#f92672>=</span>rank[u]<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span> i : a) cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;T&#34;</span><span style=color:#f92672>&lt;&lt;</span>i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39; &#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=h>H
<a href=#h class=h-anchor aria-hidden=true>#</a></h3><p>根据deadline排序，然后维护有多少槽位可供不需要纸的和需要纸的人用（代码里的<code>have</code>数组）,不需要纸的人也可以用需要纸的人的槽位。然后根据人数相应的更新数组。</p><p>队友的赛时的源代码</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> collections <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> functools <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> math <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>input <span style=color:#f92672>=</span> sys<span style=color:#f92672>.</span>stdin<span style=color:#f92672>.</span>readline
</span></span><span style=display:flex><span>sys<span style=color:#f92672>.</span>setrecursionlimit(<span style=color:#ae81ff>2147483647</span>)
</span></span><span style=display:flex><span>ml <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span>: map(int, input()<span style=color:#f92672>.</span>split())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>s, n <span style=color:#f92672>=</span> ml()
</span></span><span style=display:flex><span>people <span style=color:#f92672>=</span> defaultdict(<span style=color:#66d9ef>lambda</span>: [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(n):
</span></span><span style=display:flex><span>    deadline, need <span style=color:#f92672>=</span> input()<span style=color:#f92672>.</span>split()
</span></span><span style=display:flex><span>    deadline <span style=color:#f92672>=</span> int(deadline)
</span></span><span style=display:flex><span>    people[deadline][need[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;y&#34;</span>] <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>have <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>prev <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> deadline <span style=color:#f92672>in</span> sorted(people<span style=color:#f92672>.</span>keys()):
</span></span><span style=display:flex><span>    have[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+=</span> deadline <span style=color:#f92672>-</span> prev
</span></span><span style=display:flex><span>    have[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+=</span> (deadline <span style=color:#f92672>-</span> prev) <span style=color:#f92672>*</span> (s <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    prev <span style=color:#f92672>=</span> deadline
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    dont, need <span style=color:#f92672>=</span> people[deadline]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    do <span style=color:#f92672>=</span> min(dont, have[<span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>    dont <span style=color:#f92672>-=</span> do
</span></span><span style=display:flex><span>    have[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>-=</span> do
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> dont <span style=color:#f92672>+</span> need <span style=color:#f92672>&gt;</span> have[<span style=color:#ae81ff>1</span>]:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;No&#34;</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    have[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>-=</span> dont <span style=color:#f92672>+</span> need
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;Yes&#34;</span>)
</span></span></code></pre></div><p>我用C++又写了一遍:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define all(x) (x).begin(),(x).end()
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define sz(x) int(x.size())
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> ll <span style=color:#f92672>=</span> <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> pii <span style=color:#f92672>=</span> pair<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> rd(T<span style=color:#f92672>&amp;</span>... args) {((cin<span style=color:#f92672>&gt;&gt;</span>args), ...);}
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> wr(T... args) {((cout<span style=color:#f92672>&lt;&lt;</span>args<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; &#34;</span>), ...); cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;\n&#39;</span>;}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    ios<span style=color:#f92672>::</span>sync_with_stdio(false);
</span></span><span style=display:flex><span>    cin.tie(<span style=color:#66d9ef>nullptr</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> s, n;
</span></span><span style=display:flex><span>    cin<span style=color:#f92672>&gt;&gt;</span>s<span style=color:#f92672>&gt;&gt;</span>n;
</span></span><span style=display:flex><span>    map<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, array<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, <span style=color:#ae81ff>2</span><span style=color:#f92672>&gt;&gt;</span> people;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span>n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> deadline;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>char</span> need;
</span></span><span style=display:flex><span>        cin<span style=color:#f92672>&gt;&gt;</span>deadline<span style=color:#f92672>&gt;&gt;</span>need;
</span></span><span style=display:flex><span>        people[deadline][need<span style=color:#f92672>==</span><span style=color:#e6db74>&#39;y&#39;</span>]<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    ll have[<span style=color:#ae81ff>2</span>]{};
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> prev<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> [deadline, v] <span style=color:#f92672>:</span> people) {
</span></span><span style=display:flex><span>        have[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>+=</span>deadline<span style=color:#f92672>-</span>prev;
</span></span><span style=display:flex><span>        have[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>+=</span>ll(deadline<span style=color:#f92672>-</span>prev)<span style=color:#f92672>*</span>(s<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        prev<span style=color:#f92672>=</span>deadline;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>auto</span> [dont, need]<span style=color:#f92672>=</span>v;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> Do<span style=color:#f92672>=</span>min<span style=color:#f92672>&lt;</span>ll<span style=color:#f92672>&gt;</span>(dont, have[<span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>        dont<span style=color:#f92672>-=</span>Do;
</span></span><span style=display:flex><span>        have[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>-=</span>Do;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (dont<span style=color:#f92672>+</span>need<span style=color:#f92672>&gt;</span>have[<span style=color:#ae81ff>1</span>]) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;No</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        have[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>-=</span>dont<span style=color:#f92672>+</span>need;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;Yes</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=i>I
<a href=#i class=h-anchor aria-hidden=true>#</a></h3><p>还没补</p><h3 id=j>J
<a href=#j class=h-anchor aria-hidden=true>#</a></h3><p>根据题意模拟即可</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define all(x) (x).begin(),(x).end()
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define sz(x) int(x.size())
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> ll <span style=color:#f92672>=</span> <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> pii <span style=color:#f92672>=</span> pair<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> rd(T<span style=color:#f92672>&amp;</span>... args) {((cin<span style=color:#f92672>&gt;&gt;</span>args), ...);}
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> wr(T... args) {((cout<span style=color:#f92672>&lt;&lt;</span>args<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; &#34;</span>), ...); cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;\n&#39;</span>;}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    ios<span style=color:#f92672>::</span>sync_with_stdio(false);
</span></span><span style=display:flex><span>    cin.tie(<span style=color:#66d9ef>nullptr</span>);
</span></span><span style=display:flex><span>    vector a(<span style=color:#ae81ff>9</span>, vector(<span style=color:#ae81ff>9</span>, <span style=color:#ae81ff>0</span>));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> v: a) <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> i : v) cin<span style=color:#f92672>&gt;&gt;</span>i;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> check_row<span style=color:#f92672>=</span>[<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>int</span> row, <span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> cnt, <span style=color:#66d9ef>int</span> x) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            cnt[row][i][x]<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> check_col<span style=color:#f92672>=</span>[<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>int</span> col, <span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> cnt, <span style=color:#66d9ef>int</span> x) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            cnt[i][col][x]<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> check_grid<span style=color:#f92672>=</span>[<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>int</span> r, <span style=color:#66d9ef>int</span> c, <span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> cnt, <span style=color:#66d9ef>int</span> x) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> num<span style=color:#f92672>=</span>r<span style=color:#f92672>/</span><span style=color:#ae81ff>3</span><span style=color:#f92672>*</span><span style=color:#ae81ff>3</span><span style=color:#f92672>+</span>c<span style=color:#f92672>/</span><span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>        r<span style=color:#f92672>=</span>num<span style=color:#f92672>/</span><span style=color:#ae81ff>3</span><span style=color:#f92672>*</span><span style=color:#ae81ff>3</span>, c<span style=color:#f92672>=</span>num<span style=color:#f92672>%</span><span style=color:#ae81ff>3</span><span style=color:#f92672>*</span><span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span>r; i<span style=color:#f92672>&lt;</span>r<span style=color:#f92672>+</span><span style=color:#ae81ff>3</span>; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j<span style=color:#f92672>=</span>c; j<span style=color:#f92672>&lt;</span>c<span style=color:#f92672>+</span><span style=color:#ae81ff>3</span>; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                cnt[i][j][x]<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> count_row<span style=color:#f92672>=</span>[<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>int</span> row, <span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> cnt, <span style=color:#66d9ef>int</span> x) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> c<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (a[row][i]) <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>            c<span style=color:#f92672>+=</span>cnt[row][i][x];
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> c;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> count_col<span style=color:#f92672>=</span>[<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>int</span> col, <span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> cnt, <span style=color:#66d9ef>int</span> x) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> c<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (a[i][col]) <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>            c<span style=color:#f92672>+=</span>cnt[i][col][x];
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> c;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> count_grid<span style=color:#f92672>=</span>[<span style=color:#f92672>&amp;</span>](<span style=color:#66d9ef>int</span> r, <span style=color:#66d9ef>int</span> c, <span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> cnt, <span style=color:#66d9ef>int</span> x) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> num<span style=color:#f92672>=</span>r<span style=color:#f92672>/</span><span style=color:#ae81ff>3</span><span style=color:#f92672>*</span><span style=color:#ae81ff>3</span><span style=color:#f92672>+</span>c<span style=color:#f92672>/</span><span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>        r<span style=color:#f92672>=</span>num<span style=color:#f92672>/</span><span style=color:#ae81ff>3</span><span style=color:#f92672>*</span><span style=color:#ae81ff>3</span>, c<span style=color:#f92672>=</span>num<span style=color:#f92672>%</span><span style=color:#ae81ff>3</span><span style=color:#f92672>*</span><span style=color:#ae81ff>3</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> cc<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span>r; i<span style=color:#f92672>&lt;</span>r<span style=color:#f92672>+</span><span style=color:#ae81ff>3</span>; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j<span style=color:#f92672>=</span>c; j<span style=color:#f92672>&lt;</span>c<span style=color:#f92672>+</span><span style=color:#ae81ff>3</span>; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (a[i][j]) <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>                cc<span style=color:#f92672>+=</span>cnt[i][j][x];
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> cc;
</span></span><span style=display:flex><span>    };
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (true) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> found<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>        vector cnt(<span style=color:#ae81ff>9</span>, vector(<span style=color:#ae81ff>9</span>, vector(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>1</span>)));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; j<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                cnt[i][j][<span style=color:#ae81ff>0</span>]<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (a[i][j]<span style=color:#f92672>!=</span><span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>                    check_col(j, cnt, a[i][j]);
</span></span><span style=display:flex><span>                    check_row(i, cnt, a[i][j]);
</span></span><span style=display:flex><span>                    check_grid(i, j, cnt, a[i][j]);
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; j<span style=color:#f92672>&lt;</span><span style=color:#ae81ff>9</span>; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (a[i][j]<span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (count(all(cnt[i][j]), <span style=color:#ae81ff>1</span>)<span style=color:#f92672>==</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>                        found<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>auto</span> it<span style=color:#f92672>=</span>find(all(cnt[i][j]), <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>                        a[i][j]<span style=color:#f92672>=</span>it<span style=color:#f92672>-</span>cnt[i][j].begin();
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>goto</span> next;
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> v<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>; v<span style=color:#f92672>&lt;=</span><span style=color:#ae81ff>9</span>; v<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>if</span> ((count_col(j, cnt, v)<span style=color:#f92672>==</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> count_row(i, cnt, v)<span style=color:#f92672>==</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> count_grid(i, j, cnt, v)<span style=color:#f92672>==</span><span style=color:#ae81ff>1</span>) <span style=color:#f92672>&amp;&amp;</span> cnt[i][j][v]) {
</span></span><span style=display:flex><span>                            found<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>                            a[i][j]<span style=color:#f92672>=</span>v;
</span></span><span style=display:flex><span>                            <span style=color:#66d9ef>goto</span> next;
</span></span><span style=display:flex><span>                        }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>next:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (found<span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> cc<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> v : a) <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span> i : v) cc<span style=color:#f92672>+=</span>i<span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (cc) {
</span></span><span style=display:flex><span>        cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;Not easy</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> v : a) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> i : v) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (i<span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>) cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;.&#39;</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>else</span> cout<span style=color:#f92672>&lt;&lt;</span>i;
</span></span><span style=display:flex><span>                cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39; &#39;</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;\n&#39;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34;Easy</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> v : a) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span> i : v) cout<span style=color:#f92672>&lt;&lt;</span>i<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39; &#39;</span>;
</span></span><span style=display:flex><span>            cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;\n&#39;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=k>K
<a href=#k class=h-anchor aria-hidden=true>#</a></h3><p>我们可以用一次实验把当前问题变成两个更小的子问题，假设当前的最大高度是<code>h</code>, 还剩<code>n</code>个pallet，如果我们用<code>x</code>个箱子试一次，如果pallet坏了的话那么问题就变成了：最大高度为<code>h-1</code>, 还剩<code>n-1</code>个pallet；如果没坏的话问题就变成了高度为<code>h-x</code>，还剩<code>x</code>个pallet。所以我们可以用dp。求范围的过程与dp类似。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define all(x) (x).begin(),(x).end()
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define sz(x) int(x.size())
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> ll <span style=color:#f92672>=</span> <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> pii <span style=color:#f92672>=</span> pair<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> rd(T<span style=color:#f92672>&amp;</span>... args) {((cin<span style=color:#f92672>&gt;&gt;</span>args), ...);}
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> wr(T... args) {((cout<span style=color:#f92672>&lt;&lt;</span>args<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; &#34;</span>), ...); cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;\n&#39;</span>;}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    ios<span style=color:#f92672>::</span>sync_with_stdio(false);
</span></span><span style=display:flex><span>    cin.tie(<span style=color:#66d9ef>nullptr</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n, m;
</span></span><span style=display:flex><span>    cin<span style=color:#f92672>&gt;&gt;</span>n<span style=color:#f92672>&gt;&gt;</span>m;
</span></span><span style=display:flex><span>    vector need(n<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>, vector(m<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; i<span style=color:#f92672>&lt;=</span>n; i<span style=color:#f92672>++</span>) need[i][<span style=color:#ae81ff>1</span>]<span style=color:#f92672>=</span>i;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>; i<span style=color:#f92672>&lt;=</span>n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> pallet<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>; pallet<span style=color:#f92672>&lt;=</span>m; pallet<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> mn<span style=color:#f92672>=</span>n<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>; j<span style=color:#f92672>&lt;=</span>i; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>int</span> v1<span style=color:#f92672>=</span>need[j<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][pallet<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>], v2<span style=color:#f92672>=</span>need[i<span style=color:#f92672>-</span>j][pallet];
</span></span><span style=display:flex><span>                mn<span style=color:#f92672>=</span>min(mn, max(v1, v2));
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            need[i][pallet]<span style=color:#f92672>=</span>mn<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> l<span style=color:#f92672>=</span>n, r<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> ans<span style=color:#f92672>=</span>need[n][m];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>; i<span style=color:#f92672>&lt;=</span>n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (max(need[i<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>][m<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>], need[n<span style=color:#f92672>-</span>i][m])<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#f92672>==</span>ans){
</span></span><span style=display:flex><span>            l<span style=color:#f92672>=</span>min(l, i);
</span></span><span style=display:flex><span>            r<span style=color:#f92672>=</span>max(r, i);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    cout<span style=color:#f92672>&lt;&lt;</span>ans<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39; &#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (l<span style=color:#f92672>==</span>r) cout<span style=color:#f92672>&lt;&lt;</span>l;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span> cout<span style=color:#f92672>&lt;&lt;</span>l<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;-&#39;</span><span style=color:#f92672>&lt;&lt;</span>r;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>队友的二分做法：（和扔鸡蛋问题类似）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> collections <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> functools <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> math <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>input <span style=color:#f92672>=</span> sys<span style=color:#f92672>.</span>stdin<span style=color:#f92672>.</span>readline
</span></span><span style=display:flex><span>sys<span style=color:#f92672>.</span>setrecursionlimit(<span style=color:#ae81ff>2147483647</span>)
</span></span><span style=display:flex><span>ml <span style=color:#f92672>=</span> <span style=color:#66d9ef>lambda</span>: map(int, input()<span style=color:#f92672>.</span>split())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>binomialCoeff</span>(x, n, k):
</span></span><span style=display:flex><span>    sum <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    term <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (i <span style=color:#f92672>&lt;=</span> n <span style=color:#f92672>and</span> sum <span style=color:#f92672>&lt;</span> k):
</span></span><span style=display:flex><span>        term <span style=color:#f92672>*=</span> x <span style=color:#f92672>-</span> i <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        term <span style=color:#f92672>/=</span> i
</span></span><span style=display:flex><span>        sum <span style=color:#f92672>+=</span> term
</span></span><span style=display:flex><span>        i <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sum
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>minTrials</span>(eggs, floors):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> eggs <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> floors <span style=color:#f92672>and</span> inf
</span></span><span style=display:flex><span>    low <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    high <span style=color:#f92672>=</span> floors
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> low <span style=color:#f92672>&lt;</span> high:
</span></span><span style=display:flex><span>        mid <span style=color:#f92672>=</span> low <span style=color:#f92672>+</span> high <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> binomialCoeff(mid, eggs, floors) <span style=color:#f92672>&lt;</span> floors:
</span></span><span style=display:flex><span>            low <span style=color:#f92672>=</span> mid <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            high <span style=color:#f92672>=</span> mid
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> low
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>findX</span>(eggs, floors):
</span></span><span style=display:flex><span>    low <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    high <span style=color:#f92672>=</span> floors
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> low <span style=color:#f92672>&lt;</span> high:
</span></span><span style=display:flex><span>        mid <span style=color:#f92672>=</span> low <span style=color:#f92672>+</span> high <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> minTrials(eggs, floors <span style=color:#f92672>-</span> mid) <span style=color:#f92672>&lt;=</span> ans <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>            high <span style=color:#f92672>=</span> mid
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            low <span style=color:#f92672>=</span> mid <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> low
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>findY</span>(eggs, floors):
</span></span><span style=display:flex><span>    low <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    high <span style=color:#f92672>=</span> floors
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> low <span style=color:#f92672>&lt;</span> high:
</span></span><span style=display:flex><span>        mid <span style=color:#f92672>=</span> low <span style=color:#f92672>+</span> high <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> minTrials(eggs <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, mid <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>&lt;=</span> ans <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>            low <span style=color:#f92672>=</span> mid
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            high <span style=color:#f92672>=</span> mid <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> low
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># range: x to y</span>
</span></span><span style=display:flex><span>floors, eggs <span style=color:#f92672>=</span> ml()
</span></span><span style=display:flex><span>n <span style=color:#f92672>=</span> floors
</span></span><span style=display:flex><span>m <span style=color:#f92672>=</span> eggs
</span></span><span style=display:flex><span><span style=color:#75715e># worst case: doesn&#39;t break on x and breaks on y</span>
</span></span><span style=display:flex><span><span style=color:#75715e># find smallest x s.t. minTrials(floors - x, eggs) &lt;= ans - 1</span>
</span></span><span style=display:flex><span><span style=color:#75715e># find biggest y s.t. minTrials(y - 1, eggs - 1) &lt;= ans - 1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ans <span style=color:#f92672>=</span> minTrials(eggs, floors)
</span></span><span style=display:flex><span>x <span style=color:#f92672>=</span> findX(eggs, floors)
</span></span><span style=display:flex><span>y <span style=color:#f92672>=</span> findY(eggs, floors)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> x <span style=color:#f92672>==</span> y:
</span></span><span style=display:flex><span>    print(ans, x)
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    print(ans, str(x) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;-&#34;</span> <span style=color:#f92672>+</span> str(y))
</span></span></code></pre></div><h3 id=l>L
<a href=#l class=h-anchor aria-hidden=true>#</a></h3><p>可以观察到一定是上面的几个门用A通道，剩下下面的用B通道，所以可以枚举A和B分界的位置，然后剩下的问题就是公寓匹配门、门匹配工作站了，跑两次二分图最大权匹配即可。之前做过匹配的题的话这题应该是很简单的，可以当时没人读到，但队友读了也不一定能反应过来是匹配问题233。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>#define all(x) (x).begin(),(x).end()
</span></span></span><span style=display:flex><span><span style=color:#75715e>#define sz(x) int(x.size())
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> <span style=color:#66d9ef>namespace</span> std;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> ll <span style=color:#f92672>=</span> <span style=color:#66d9ef>long</span> <span style=color:#66d9ef>long</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> pii <span style=color:#f92672>=</span> pair<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, <span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> rd(T<span style=color:#f92672>&amp;</span>... args) {((cin<span style=color:#f92672>&gt;&gt;</span>args), ...);}
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span>... T<span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>void</span> wr(T... args) {((cout<span style=color:#f92672>&lt;&lt;</span>args<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#34; &#34;</span>), ...); cout<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;\n&#39;</span>;}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>template</span><span style=color:#f92672>&lt;</span><span style=color:#66d9ef>typename</span> T<span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Hungarian</span> {
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n, m;
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span> vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> <span style=color:#f92672>&gt;</span> a;
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> u, v;
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> pa, pb, way;
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span> minv;
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>bool</span><span style=color:#f92672>&gt;</span> used;
</span></span><span style=display:flex><span>    T inf;
</span></span><span style=display:flex><span>    Hungarian(<span style=color:#66d9ef>int</span> _n, <span style=color:#66d9ef>int</span> _m) <span style=color:#f92672>:</span> n(_n), m(_m), a(n, vector<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;</span>(m)), u(n<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>), v(m<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>), pa(n<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>), pb(m<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>), way(m, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>), minv(m), used(m<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>        assert(n <span style=color:#f92672>&lt;=</span> m);
</span></span><span style=display:flex><span>        inf <span style=color:#f92672>=</span> numeric_limits<span style=color:#f92672>&lt;</span>T<span style=color:#f92672>&gt;::</span>max();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>inline</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>add_row</span>(<span style=color:#66d9ef>int</span> i) {
</span></span><span style=display:flex><span>        fill(minv.begin(), minv.end(), inf);
</span></span><span style=display:flex><span>        fill(used.begin(), used.end(), false);
</span></span><span style=display:flex><span>        pb[m] <span style=color:#f92672>=</span> i;
</span></span><span style=display:flex><span>        pa[i] <span style=color:#f92672>=</span> m;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>int</span> j0 <span style=color:#f92672>=</span> m;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>do</span> {
</span></span><span style=display:flex><span>            used[j0] <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> i0 <span style=color:#f92672>=</span> pb[j0];
</span></span><span style=display:flex><span>            T delta <span style=color:#f92672>=</span> inf;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> j1 <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;</span> m; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>used[j]) {
</span></span><span style=display:flex><span>                    T cur <span style=color:#f92672>=</span> a[i0][j] <span style=color:#f92672>-</span> u[i0] <span style=color:#f92672>-</span> v[j];
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (cur <span style=color:#f92672>&lt;</span> minv[j]) {
</span></span><span style=display:flex><span>                        minv[j] <span style=color:#f92672>=</span> cur;
</span></span><span style=display:flex><span>                        way[j] <span style=color:#f92672>=</span> j0;
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>if</span> (minv[j] <span style=color:#f92672>&lt;</span> delta) {
</span></span><span style=display:flex><span>                        delta <span style=color:#f92672>=</span> minv[j];
</span></span><span style=display:flex><span>                        j1 <span style=color:#f92672>=</span> j;
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; j <span style=color:#f92672>&lt;=</span> m; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (used[j]) {
</span></span><span style=display:flex><span>                    u[pb[j]] <span style=color:#f92672>+=</span> delta;
</span></span><span style=display:flex><span>                    v[j] <span style=color:#f92672>-=</span> delta;
</span></span><span style=display:flex><span>                } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                    minv[j] <span style=color:#f92672>-=</span> delta;
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            j0 <span style=color:#f92672>=</span> j1;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>while</span> (pb[j0] <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>do</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span> j1 <span style=color:#f92672>=</span> way[j0];
</span></span><span style=display:flex><span>            pb[j0] <span style=color:#f92672>=</span> pb[j1];
</span></span><span style=display:flex><span>            pa[pb[j0]] <span style=color:#f92672>=</span> j0;
</span></span><span style=display:flex><span>            j0 <span style=color:#f92672>=</span> j1;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>while</span> (j0 <span style=color:#f92672>!=</span> m);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>inline</span> T <span style=color:#a6e22e>current_score</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#f92672>-</span>v[m];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>inline</span> T <span style=color:#a6e22e>solve</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            add_row(i);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> current_score();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    ios<span style=color:#f92672>::</span>sync_with_stdio(false);
</span></span><span style=display:flex><span>    cin.tie(<span style=color:#66d9ef>nullptr</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> n;
</span></span><span style=display:flex><span>    cin<span style=color:#f92672>&gt;&gt;</span>n;
</span></span><span style=display:flex><span>    vector g1(n, vector(<span style=color:#ae81ff>2</span><span style=color:#f92672>*</span>n, <span style=color:#ae81ff>0</span>));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>auto</span> g2<span style=color:#f92672>=</span>g1;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> v : g1)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> i : v) cin<span style=color:#f92672>&gt;&gt;</span>i;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> v : g2)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span><span style=color:#f92672>&amp;</span> i : v) cin<span style=color:#f92672>&gt;&gt;</span>i;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>int</span> mn_cost<span style=color:#f92672>=</span><span style=color:#ae81ff>1e9</span>;
</span></span><span style=display:flex><span>    vector<span style=color:#f92672>&lt;</span>array<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span>, <span style=color:#ae81ff>3</span><span style=color:#f92672>&gt;&gt;</span> ans(n);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=-</span><span style=color:#ae81ff>1</span>; i<span style=color:#f92672>&lt;</span>n; i<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        vector ng1(n, vector(n, <span style=color:#ae81ff>0</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>auto</span> ng2<span style=color:#f92672>=</span>ng1;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; j<span style=color:#f92672>&lt;</span>n; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> u<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; u<span style=color:#f92672>&lt;</span>n; u<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                ng1[u][j]<span style=color:#f92672>=</span>g1[u][j<span style=color:#f92672>*</span><span style=color:#ae81ff>2</span><span style=color:#f92672>+</span>(j<span style=color:#f92672>&gt;</span>i)];
</span></span><span style=display:flex><span>                ng2[u][j]<span style=color:#f92672>=</span>g2[u][j<span style=color:#f92672>*</span><span style=color:#ae81ff>2</span><span style=color:#f92672>+</span>(j<span style=color:#f92672>&gt;</span>i)];
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        Hungarian<span style=color:#f92672>&lt;</span><span style=color:#66d9ef>int</span><span style=color:#f92672>&gt;</span> h1(n, n), h2(n, n);
</span></span><span style=display:flex><span>        h1.a<span style=color:#f92672>=</span>ng1, h2.a<span style=color:#f92672>=</span>ng2;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>int</span> cur<span style=color:#f92672>=</span>h1.solve() <span style=color:#f92672>+</span> h2.solve(); cur <span style=color:#f92672>&lt;</span>mn_cost) {
</span></span><span style=display:flex><span>            mn_cost<span style=color:#f92672>=</span>cur;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>int</span> j<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>; j<span style=color:#f92672>&lt;</span>n; j<span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                ans[j]<span style=color:#f92672>=</span>{j, h1.pa[j]<span style=color:#f92672>*</span><span style=color:#ae81ff>2</span><span style=color:#f92672>+</span>(h1.pa[j]<span style=color:#f92672>&gt;</span>i),h2.pb[h1.pa[j]]};
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    cout<span style=color:#f92672>&lt;&lt;</span>mn_cost<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;\n&#39;</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>auto</span> [x, y , z] <span style=color:#f92672>:</span> ans) {
</span></span><span style=display:flex><span>        cout<span style=color:#f92672>&lt;&lt;</span>x<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>&lt;&lt;</span>y<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#66d9ef>char</span>(<span style=color:#e6db74>&#39;A&#39;</span><span style=color:#f92672>+</span>y<span style=color:#f92672>%</span><span style=color:#ae81ff>2</span>)<span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>&lt;&lt;</span>z<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#e6db74>&#39;\n&#39;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div></div><footer class=footer><div class=footer__inner><a href=/zh class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>Thallium54</span></a><div class=copyright><span>© 2022 Powered by
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme by
<a href=https://twitter.com/panr target=_blank rel=noopener>panr</a>, moded by me</span></div></div></footer><script src=https://tgc54.com/assets/main.js></script>
<script src=https://tgc54.com/assets/prism.js></script></div></body></html>