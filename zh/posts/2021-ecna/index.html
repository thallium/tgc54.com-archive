<!doctype html><html lang=zh><head><title>2021 ECNAåŒºåŸŸèµ›æ€»ç»“ä¸é¢˜è§£ ::
Thallium54</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="å·®ä¸å¤šæœ€åä¸€å¹´äº†ï¼Œæ˜å¹´é˜Ÿå‹ä¼°è®¡å°±éƒ½æ¯•ä¸šäº†ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°å…¶ä»–äººå§ï¼Œæˆ–è€…soloä¹Ÿè¡Œï¼Ÿ
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://tgc54.com/zh/posts/2021-ecna/><link rel=stylesheet href=https://tgc54.com/assets/style.css><link rel=stylesheet href=https://tgc54.com/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://tgc54.com/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://tgc54.com/img/favicon.png><link href=https://tgc54.com/assets/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://tgc54.com/assets/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://tgc54.com/assets/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://tgc54.com/assets/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://tgc54.com/assets/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=https://tgc54.com/assets/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary"><meta name=twitter:title content="2021 ECNAåŒºåŸŸèµ›æ€»ç»“ä¸é¢˜è§£"><meta name=twitter:description content="å·®ä¸å¤šæœ€åä¸€å¹´äº†ï¼Œæ˜å¹´é˜Ÿå‹ä¼°è®¡å°±éƒ½æ¯•ä¸šäº†ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°å…¶ä»–äººå§ï¼Œæˆ–è€…soloä¹Ÿè¡Œï¼Ÿ"><meta property="og:title" content="2021 ECNAåŒºåŸŸèµ›æ€»ç»“ä¸é¢˜è§£"><meta property="og:description" content="å·®ä¸å¤šæœ€åä¸€å¹´äº†ï¼Œæ˜å¹´é˜Ÿå‹ä¼°è®¡å°±éƒ½æ¯•ä¸šäº†ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°å…¶ä»–äººå§ï¼Œæˆ–è€…soloä¹Ÿè¡Œï¼Ÿ"><meta property="og:type" content="article"><meta property="og:url" content="https://tgc54.com/zh/posts/2021-ecna/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-26T21:07:17-05:00"><meta property="article:modified_time" content="2022-02-26T21:07:17-05:00"><meta property="og:site_name" content="Thallium54"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css integrity=sha384-Xi8rHCmBmhbuyyhbI88391ZKP2dmfnOl4rT9ZfRI7mLTdk1wblIUnrIq35nqwEvC crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js integrity=sha384-X/XCfMm41VSsqRNQgDerQczD69XqmjOOOwYQvr/uuC+j4OPoNhVgjdGFwhvN02Ja crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})'></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"></head><body><div class=container><header class=header><span class=header__inner><a href=/zh class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>Thallium54</span></a>
<span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/zh/posts>åšæ–‡</a></li><li><a href=/zh/categories>åˆ†ç±»</a></li><li><a href=/zh/tags>æ ‡ç­¾</a></li><li><a href=https://wiki.tgc54.com>Wiki</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/zh/posts>åšæ–‡</a></li><li><a href=/zh/categories>åˆ†ç±»</a></li><li><a href=/zh/tags>æ ‡ç­¾</a></li><li><a href=https://wiki.tgc54.com>Wiki</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span><span class=theme-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-circle-half-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><path d="M12 3v18"/><path d="M12 14l7-7"/><path d="M12 19l8.5-8.5"/><path d="M12 9l4.5-4.5"/></svg></span><span class=lang-toggle><div class="dropdown menu__sub-inner"><div class=link><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-world" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="12" cy="12" r="9"/><line x1="3.6" y1="9" x2="20.4" y2="9"/><line x1="3.6" y1="15" x2="20.4" y2="15"/><path d="M11.5 3a17 17 0 000 18"/><path d="M12.5 3a17 17 0 010 18"/></svg></div><ul class=menu__sub-inner-more><li><a href=https://tgc54.com/zh/posts/2021-ecna/>ç®€ä½“ä¸­æ–‡</a></li></ul></div></span></span></span></header><div class=content><div class=post><h1 class=post-title>2021 ECNAåŒºåŸŸèµ›æ€»ç»“ä¸é¢˜è§£</h1><div class=post-meta><span class=post-date>2022-02-26</span></div><div class=post-content><p>å·®ä¸å¤šæœ€åä¸€å¹´äº†ï¼Œæ˜å¹´é˜Ÿå‹ä¼°è®¡å°±éƒ½æ¯•ä¸šäº†ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½æ‰¾åˆ°å…¶ä»–äººå§ï¼Œæˆ–è€…soloä¹Ÿè¡Œï¼Ÿ</p><h2 id=æ€»ç»“>æ€»ç»“
<a href=#%e6%80%bb%e7%bb%93 class=h-anchor aria-hidden=true>#</a></h2><p>ä»Šå¹´ç”±äºç–«æƒ…ä¾ç„¶ä¸èƒ½å»æ¸©èçº¿ä¸‹æ¯”èµ›ï¼Œä½†ç›¸æ¯”å»å¹´ä¸‰äººä¸‰æœºä»Šå¤©å˜æˆäº†æ›´åƒçº¿ä¸‹çš„ä¸‰äººä¸€æœºï¼Œä¸è¿‡æ˜¯åœ¨å„è‡ªå­¦æ ¡æ¯”èµ›ï¼Œä½†ä»¤äººä¸èƒ½ç†è§£æ˜¯çš„å±…ç„¶ä¸€ç‚¹ç›‘æ§æªæ–½éƒ½æ²¡æœ‰ï¼Œå…¨å‡­è‡ªå·±è‡ªè§‰å’Œæ•™ç»ƒç›‘ç£ã€‚ã€‚ã€‚ã€‚å¯ä»¥ç†è§£ä¸ºæ‘†çƒ‚å§ğŸ˜‚ã€‚æˆ‘ä»¬é˜Ÿç®—æ˜¯åšåˆ°äº†éµå¾ªè§„åˆ™ï¼Œé™¤äº†å¤šæ¥äº†ä¸€ä¸ªæ˜¾ç¤ºå™¨ç”¨æ¥çœ‹ä»£ç ï¼ˆè‡ªå·±ç”µè„‘æ²¡æ³•è¿æœºæˆ¿çš„æ‰“å°æœºï¼‰ï¼Œä»¥åŠæˆ‘è¿˜æ˜¯ç”¨çš„è‡ªå·±çš„é”®ç›˜ï¼ˆç”¨40%é…åˆ—å¤ªä¹…äº†æ”¹ä¸å›æ¥äº†ï¼‰ã€‚</p><p><a href=https://ecna21.kattis.com/standings>æ’å</a>æœ‰ç‚¹å‡ºä¹æ„æ–™ï¼Œè€ƒè™‘åˆ°é˜Ÿå‹å¿™äºå®ä¹ ä»ä¸è®­ç»ƒã€æˆ‘ä¸Šäº†å¤§ä¸‰ä¹‹åè¯¾ç¨‹éš¾åº¦å¢åŠ ï¼Œåªèƒ½é æ¯å‘¨cfç»´æŒä¸€ç‚¹åšé¢˜é‡ï¼Œè¿™ä¸ªæ’åå·²ç»å¾ˆæ»¡æ„äº†ï¼Œæ¯•ç«Ÿå¦‚æœæŒ‰NACæ™‹çº§è§„åˆ™æŒ‰å­¦æ ¡æ’åæ˜¯ç¬¬6ï¼Œæ ¡æ’åè¦æ˜¯ç¬¬5çš„è¯æ€»æ’åè¦ç¬¬6ï¼Œå®Œå…¨æƒ³peachğŸ˜‚ã€‚</p><p>æ•´åœºæ¯”èµ›è¿˜æ˜¯æ¯”è¾ƒæµç•…çš„ï¼ŒåŸºæœ¬æ²¡æœ‰å¡å¤ªé•¿æ—¶é—´ï¼ŒAé¢˜ä½œä¸ºæ¯”è¾ƒç®€å•çš„é¢˜å¡äº†æœ‰ç‚¹ä¹…ï¼Œæœ€åè¿˜æ˜¯é çŒœç»“è®ºè¿‡çš„ï¼ŒFè®¡ç®—å‡ ä½•æŸé˜Ÿå‹åˆ°æœ€åä¹Ÿæ²¡æå‡ºæ¥ï¼Œä¸è¿‡æ²¡å ç”¨å¤ªå¤šæ­£å¸¸æ—¶é—´ã€‚æ—¶é—´å†ç¨å¾®å¤šä¸€ç‚¹ä¹Ÿè®¸èƒ½ææIæˆ–è€…Kï¼Œä¸è¿‡åˆ°æœ€åä¹Ÿæ¯”æœ‰ç‚¹ç´¯äº†ï¼Œæ˜¨æ™šä¹Ÿåªç¡äº†5ä¸ªåŠå°æ—¶ã€‚</p><h2 id=é¢˜ç›®>é¢˜ç›®
<a href=#%e9%a2%98%e7%9b%ae class=h-anchor aria-hidden=true>#</a></h2><p>é¢˜ç›®æ•´ä½“éš¾åº¦é€‚ä¸­ï¼Ÿæ¯”å»å¹´éš¾ä¸€ç‚¹ï¼Œï¼ˆè¯»äº†çš„é¢˜ï¼‰ä»¥æ€ç»´é¢˜ä¸ºä¸»ã€‚é™¤äº†Jé¢˜æ‘†çƒ‚å‡ºäº†æœ€å¤§å­çŸ©å½¢åŸé¢˜ï¼Œé¢˜ç›®è´¨é‡è¿˜å¯ä»¥ï¼Ÿ</p><h3 id=a>A
<a href=#a class=h-anchor aria-hidden=true>#</a></h3><p>ä¸€å¼€å§‹waæ˜¯å› ä¸ºå¿˜äº†è€ƒè™‘ç›¸åŠ çš„è½¬ç§»ã€‚è€ƒè™‘åŠ çš„è¯è¦éå†ä¸€éæ•´ä¸ªdpæ•°ç»„ï¼Œæ—¶é—´å¤æ‚åº¦ä¼šå˜æˆ$O(n^2)$ï¼Œä½†å…¶å®ä¹Ÿèƒ½è¿‡å› ä¸ºæ—¶é—´ç»™äº†15sã€‚ã€‚ã€‚ï¼ˆæˆ‘tmå†™åšå®¢çš„æ—¶å€™æ‰å‘ç°ï¼‰ã€‚ä½†è²Œä¼¼åªè¦éå†å‰é¢ä¸€äº›æ•°å°±è¡Œäº†ï¼Œå› ä¸ºæ•°å¤§çš„æ—¶å€™ä¹˜è‚¯å®šæ¯”åŠ åˆ’ç®—ã€‚</p><div class=collapsable-code><input id=645789231 type=checkbox checked>
<label for=645789231><span class=collapsable-code__language>cpp</span>
<span class=collapsable-code__title>ä»£ç </span>
<span class=collapsable-code__toggle data-label-expand=â–³ data-label-collapse=â–½></span></label><pre class=language-cpp><code>

#include &lt;bits/stdc&#43;&#43;.h&gt;
using namespace std;

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    int n;
    cin &gt;&gt; n;
    vector&lt;int&gt; dp(n &#43; 1, 1e9);
    dp[1] = 1;
    for (int i = 2; i &lt;= n; i&#43;&#43;) {
        dp[i] = i;

        for (int j = 1; j &lt;= min(i / 2 &#43; 1, 1000); j&#43;&#43;)
            dp[i] = min(dp[i], dp[j] &#43; dp[i - j]);

        string s = to_string(i);
        for (int j = 1; j &lt; (int)size(s); j&#43;&#43;) {
            string s1 = s.substr(0, j), s2 = s.substr(j);
            if (s2[0] == &#39;0&#39;) continue;
            dp[i] = min(dp[i], dp[stoi(s1)] &#43; dp[stoi(s2)]);
        }

        for (int f = 2; f * f &lt;= i; f&#43;&#43;) {
            if (i % f == 0) { dp[i] = min(dp[i], dp[f] &#43; dp[i / f]); }
        }
    }
    cout &lt;&lt; dp[n] &lt;&lt; endl;
}
</code></pre></div><h3 id=b>B
<a href=#b class=h-anchor aria-hidden=true>#</a></h3><p>èµ›æ—¶æ— è„‘æ•²äº†ä¸ªlcaï¼Œä½†å…¶å®ç¨å¾®å†æƒ³æƒ³å°±æœ‰æ›´ç®€å•çš„åšæ³•ï¼šdfsæ—¶ç»´æŠ¤åˆ°æ ¹èŠ‚ç‚¹çš„è·ç¦»ä»¥åŠæœ€çŸ­çš„ä¸¤æ¡åˆ°å¶å­çš„è·¯å¾„çš„ä¸¾ä¾‹å³å¯ã€‚</p><div class=collapsable-code><input id=869245731 type=checkbox checked>
<label for=869245731><span class=collapsable-code__language>cpp</span>
<span class=collapsable-code__title>ä»£ç </span>
<span class=collapsable-code__toggle data-label-expand=â–³ data-label-collapse=â–½></span></label><pre class=language-cpp><code>
#include &lt;bits/stdc&#43;&#43;.h&gt;
using namespace std;

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    int n, m;
    cin &gt;&gt; n &gt;&gt; m;
    vector&lt;vector&lt;int&gt;&gt; g(n);
    vector&lt;int&gt; a(n);
    for (auto &amp;x : a)
        cin &gt;&gt; x;
    vector&lt;int&gt; indeg(n), sum(n), color(n);
    for (int i = 0; i &lt; m; i&#43;&#43;) {
        int u, v;
        cin &gt;&gt; u &gt;&gt; v;
        u--, v--;
        g[u].push_back(v);
        indeg[v]&#43;&#43;;
    }
    int c = 0;
    int ans = 1e9;
    auto dfs = [&amp;](auto &amp;slf, int u, int s) -&gt; int {
        sum[u] = s &#43; a[u];
        color[u] = c;
        int mn0 = 1e9, mn1 = 1e9;
        for (auto v : g[u]) {
            auto res = slf(slf, v, s &#43; a[u]);
            if (res &lt; mn1) mn1 = res;
            if (mn1 &lt; mn0) swap(mn0, mn1);
        }
        ans = min(ans, mn0 &#43; mn1 &#43; sum[u]);
        return (mn0 == 1e9 ? 0 : mn0) &#43; a[u];
    };
    for (int i = 0; i &lt; n; i&#43;&#43;) {
        if (indeg[i] == 0) {
            dfs(dfs, i, 0);
            c&#43;&#43;;
        }
    }
    for (int i = 0; i &lt; n; i&#43;&#43;) {
        for (int j = i &#43; 1; j &lt; n; j&#43;&#43;) {
            if (g[i].empty() &amp;&amp; g[j].empty()) {
                if (color[i] != color[j]) {
                    ans = min(ans, sum[i] &#43; sum[j]);
                }
            }
        }
    }
    cout &lt;&lt; ans &lt;&lt; endl;
}
</code></pre></div><h3 id=g>G
<a href=#g class=h-anchor aria-hidden=true>#</a></h3><p>ç­¾åˆ°é¢˜ï¼Œæšä¸¾æ‰€æœ‰å‰ç¼€ä»¥åŠäº¤æ¢é¡ºåºå³å¯</p><div class=collapsable-code><input id=618542973 type=checkbox checked>
<label for=618542973><span class=collapsable-code__language>cpp</span>
<span class=collapsable-code__title>ä»£ç </span>
<span class=collapsable-code__toggle data-label-expand=â–³ data-label-collapse=â–½></span></label><pre class=language-cpp><code>
#include &lt;bits/stdc&#43;&#43;.h&gt;
using namespace std;

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    string a, b, c;
    char op, _;
    cin &gt;&gt; a &gt;&gt; op &gt;&gt; b &gt;&gt; _ &gt;&gt; c;
    auto check = [&amp;](string a_, string b_, string c_) {
        __int128 a = stoll(a_), b=stoll(b_), c = stoll(c_);
        if (op==&#39;&#43;&#39;) return a&#43;b==c;
        else return a*b==c;
    };
    for (int i=1; i&lt;(int)size(a); i&#43;&#43;) {
        for (int j=1; j&lt;(int)size(b); j&#43;&#43;) {
            for (int k=1; k&lt;(int)size(c); k&#43;&#43;) {
                string a1=a.substr(0, i), a2=a.substr(0&#43;i);
                string b1=b.substr(0, j), b2=b.substr(0&#43;j);
                string c1=c.substr(0, k), c2=c.substr(0&#43;k);
                vector&lt;string&gt; s = {a1, b1, c1};
                sort(begin(s), end(s));
                do {
                    if (check(s[0]&#43;a2, s[1]&#43;b2, s[2]&#43;c2)) {
                        cout &lt;&lt; s[0]&#43;a2 &lt;&lt; &#39; &#39; &lt;&lt; op &lt;&lt; &#39; &#39; &lt;&lt;  s[1]&#43;b2 &lt;&lt; &#34; = &#34; &lt;&lt; s[2]&#43;c2;
                        exit(0);
                    }
                } while (next_permutation(begin(s), end(s)));
            }
        }
    }
}
</code></pre></div><h3 id=j>J
<a href=#j class=h-anchor aria-hidden=true>#</a></h3><p>ç»å…¸æœ€å¤§å­çŸ©é˜µï¼Œå•è°ƒæ ˆææå³å¯ã€‚å…¶å®æˆ‘èµ›æ—¶å·²ç»åŸºæœ¬å¿˜äº†æ€ä¹ˆåšäº†ï¼Œåªè®°å¾—æ˜¯æ˜¯å•è°ƒæ ˆï¼Œæƒ³äº†åŠå¤©æ‰æƒ³å‡ºæ¥æ­£è§£ï¼Œè¿™ä¸‹åº”è¯¥ä»¥åå¿˜ä¸äº†äº†233</p><div class=collapsable-code><input id=874256913 type=checkbox checked>
<label for=874256913><span class=collapsable-code__language>cpp</span>
<span class=collapsable-code__title>ä»£ç </span>
<span class=collapsable-code__toggle data-label-expand=â–³ data-label-collapse=â–½></span></label><pre class=language-cpp><code>
#include &lt;bits/stdc&#43;&#43;.h&gt;
using namespace std;
using ll = long long; //}}}

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    int n;
    cin &gt;&gt; n;
    vector&lt;int&gt; a(n);
    for (int i = 0; i &lt; n; &#43;&#43;i) {
        cin &gt;&gt; a[i];
    }
    stack&lt;pair&lt;int, int&gt;&gt; stk;
    ll ans = 0;
    int s = 1e9, e = 0;

    auto update = [&amp;](ll cur, int curs, int cure) {
        if (cur &gt; ans || (cur == ans &amp;&amp; curs &lt; s)) {
            ans = cur;
            s = curs;
            e = cure;
        }
    };
    for (int i = 0; i &lt; n; i&#43;&#43;) {
        int prev = i;
        while (!stk.empty() &amp;&amp; stk.top().first &gt;= a[i]) {
            prev = stk.top().second;
            ll cur = ll(i - prev) * stk.top().first;
            update(cur, prev, i - 1);
            stk.pop();
        }
        ll cur = ll(i - prev &#43; 1) * a[i];
        update(cur, prev, i);
        stk.push({a[i], prev});
    }
    while (!stk.empty()) {
        auto [x, i] = stk.top();
        stk.pop();
        ll cur = ll(n - i) * x;
        update(cur, i, n - 1);
    }
    cout &lt;&lt; s &#43; 1 &lt;&lt; &#39; &#39; &lt;&lt; e &#43; 1 &lt;&lt; &#39; &#39; &lt;&lt; ans &lt;&lt; endl;
}
</code></pre></div><h3 id=l>L
<a href=#l class=h-anchor aria-hidden=true>#</a></h3><p>æšä¸¾å››ä¸ªè§’ç„¶åæ’åºåˆ†å±‚æä¸€æï¼Œé˜Ÿå‹å†™çš„</p><div class=collapsable-code><input id=157329846 type=checkbox checked>
<label for=157329846><span class=collapsable-code__language>python</span>
<span class=collapsable-code__title>ä»£ç </span>
<span class=collapsable-code__toggle data-label-expand=â–³ data-label-collapse=â–½></span></label><pre class=language-python><code>
import collections
import itertools
import sys
ints = lambda: list(map(int, sys.stdin.readline().split()))
grid = []
gy, gx = ints()
for y in range(gy):
  grid.append(ints())
statues = []
for row in grid:
  for cell in row:
    if ~cell:
      statues.append(cell)
statues.sort()

def levels(grid):
  ret1 = collections.defaultdict(set)
  ret2 = collections.defaultdict(set)
  for y in range(gy):
    for x in range(gx):
      cell = grid[y][x]
      if ~cell:
        ret1[y&#43;x].add(cell)
        ret2[y-x].add(cell)
  return ret1, ret2

ret1, ret2 = levels(grid)

keys1 = sorted(ret1.keys())
keys2 = sorted(ret2.keys())

import math
moved = math.inf

for keys, ret in (keys1, ret1), (reversed(keys1), ret1), (keys2, ret2), (reversed(keys2), ret2):
  this = len(statues)
  it = iter(statues)
  for key in keys:
    st = set()
    for _ in range(len(ret[key])):
      st.add(next(it))
    this -= len(st &amp; ret[key])
  moved = min(moved, this)

print(moved)
```
</code></pre></div><h3 id=m>M
<a href=#m class=h-anchor aria-hidden=true>#</a></h3><p>æœ€çŸ­è·¯è€ƒè™‘ç”¨bfsï¼ŒæŠŠæ‰€æœ‰å­—ç¬¦ä¸²æ”¾å…¥ä¸€ä¸ªtrieå°±å¯ä»¥å¾ˆå®¹æ˜“çŸ¥é“å“ªäº›æ–¹å‘å¯ä»¥èµ°äº†ï¼Œæ‰€ä»¥çŠ¶æ€å°±æ˜¯[x][y][trieä¸­çš„èŠ‚ç‚¹çš„ä½ç½®][ä¸Šä¸€æ­¥çš„æ–¹å‘]ã€‚é™¤äº†çŠ¶æ€å¤æ‚ç‚¹å…¶ä»–å°±æ˜¯æ­£å¸¸bfsçš„å¥—è·¯ï¼Œæ³¨æ„å¦‚æœå½“å‰åœ¨å•è¯ç»“å°¾çš„ä½ç½®ï¼Œä¸‹ä¸€æ­¥å³å¯ä»¥å›åˆ°trieçš„æ ¹ï¼Œåˆå¯ä»¥ç»§ç»­é¡ºç€trieèµ°ã€‚</p><div class=collapsable-code><input id=234758169 type=checkbox checked>
<label for=234758169><span class=collapsable-code__language>cpp</span>
<span class=collapsable-code__title>ä»£ç </span>
<span class=collapsable-code__toggle data-label-expand=â–³ data-label-collapse=â–½></span></label><pre class=language-cpp><code>
#include &lt;bits/stdc&#43;&#43;.h&gt;
using namespace std;

struct Trie {
    struct node {
        map&lt;char, int&gt; ch;
        bool term;
    };
    vector&lt;node&gt; t;
    Trie() { new_node(); }
    int new_node() {
        t.emplace_back();
        return t.size() - 1;
    }
    void insert(const string &amp;s) {
        int p = 0;
        for (auto ch : s) {
            if (!t[p].ch.count(ch)) { t[p].ch[ch] = new_node(); }
            p = t[p].ch[ch];
        }
        t[p].term = true;
    }
};

int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    int n, m, k;
    cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;
    vector s(n, vector&lt;char&gt;(m));
    for (auto &amp;v : s)
        for (auto &amp;c : v)
            cin &gt;&gt; c;
    Trie tr;
    for (int i = 0; i &lt; k; i&#43;&#43;) {
        string ss;
        cin &gt;&gt; ss;
        tr.insert(ss);
    }
    vector dis(n, vector(m, vector(size(tr.t), vector(3, -1))));
    queue&lt;array&lt;int, 4&gt;&gt; q;
    for (int i = 0; i &lt; m; i&#43;&#43;) {
        if (tr.t[0].ch.count(s[0][i])) {
            int st = tr.t[0].ch[s[0][i]];
            dis[0][i][st][0] = 1;
            q.push({0, i, st, 0});
        }
    }

    const vector&lt;pair&lt;int, int&gt;&gt; dir{{1, 0}, {0, -1}, {0, 1}};
    while (!q.empty()) {
        auto [x, y, st, prev] = q.front();
        int olddis = dis[x][y][st][prev];
        q.pop();
        for (int ii = 0; ii &lt; (int)size(dir); ii&#43;&#43;) {
            auto [dx, dy] = dir[ii];
            if ((prev == 1 &amp;&amp; dy == 1) || (prev == 2 &amp;&amp; dy == -1))
                continue;
            unsigned nx = x &#43; dx, ny = y &#43; dy;
            if (nx &lt; n &amp;&amp; ny &lt; m) {
                auto go = [&amp;](int st) {
                    if (tr.t[st].ch.count(s[nx][ny])) {
                        int nst = tr.t[st].ch[s[nx][ny]];
                        if (dis[nx][ny][nst][ii] == -1) {
                            dis[nx][ny][nst][ii] = olddis &#43; 1;
                            q.push({(int)nx, (int)ny, nst, ii});
                        }
                    }
                };
                go(st);
                if (tr.t[st].term) {
                    st = 0;
                    go(st);
                }
            }
        }
    }
    int ans = 1e9;
    for (int i = 0; i &lt; m; i&#43;&#43;) {
        for (int d = 0; d &lt; 3; d&#43;&#43;) {
            for (int st = 0; st &lt; (int)size(tr.t); st&#43;&#43;) {
                if (tr.t[st].term &amp;&amp; dis[n - 1][i][st][d] != -1) {
                    ans = min(ans, dis[n - 1][i][st][d]);
                }
            }
        }
    }
    if (ans == 1e9) {
        cout &lt;&lt; &#34;impossible\n&#34;;
    } else
        cout &lt;&lt; ans &lt;&lt; endl;
}
```
</code></pre></div></div></div></div><footer class=footer><div class=footer__inner><a href=/zh class=logo style=text-decoration:none><span class=logo__mark><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg></span><span class=logo__text>Thallium54</span></a><div class=copyright><span>Â© 2022 Powered by
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme by
<a href=https://twitter.com/panr target=_blank rel=noopener>panr</a>, moded by me</span></div></div></footer><script src=https://tgc54.com/assets/main.js></script>
<script src=https://tgc54.com/assets/prism.js></script></div></body></html>